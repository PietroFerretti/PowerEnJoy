\documentclass[english]{article}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{babel}
\usepackage[unicode=true,pdfusetitle,
 bookmarks=true,bookmarksnumbered=false,bookmarksopen=false,
 breaklinks=false,pdfborder={0 0 1},backref=false,colorlinks=false]
 {hyperref}
\usepackage{breakurl}
\usepackage{tabularx}


\begin{document}

\title{Politecnico di Milano\\
 A.A. 2016–2017 \\
Software Engineering 2: “PowerEnJoy” \\
\emph{Requirements Analysis and Specification Document}}

\author{Pietro Ferretti, Nicole Gervasoni, Danilo Labanca}

\maketitle
\newpage{}

\tableofcontents{}

\newpage{}

\section{Introduction}

\subsection{Purpose}

This document is the Requirements Analysis and Specification Document
(hereinafter abbreviated as RASD). The aim of the RASD is to give
a complete and robust description of the requirements that our system
has to fulfil adopting the SO/IEC/IEEE 29148 dated Dec 2011 standard.
It also introduces the functional and non-functional requirements
via UML diagrams. In the last part of this document it presents the
formal model of the specification using Alloy analysis (language). 

The information in this document are intended for the customer and
the developers of the project. For the customer this document represents
a description useful to understand the project development and is
the equivalent of an agreement legally binding; meanwhile for the
developers it’s an useful way to coordinate the development and show
the matching between the stakeholders’ requests and the developed
solution.

\subsection{Scope}

\subsection{Definitions, Acronyms, Abbreviations}

\subsubsection{Definitions}

\subsubsection{Acronyms}

\subsubsection{Abbreviations}

\subsection{Reference Documents}

\subsection{Document Overview}

\newpage{}

\section{Overall Description}

\subsection{Product Perspective}

\subsection{Product Functions}

\subsection{User Characteristics}

\subsection{Constraints}

To provide all the functionalities specified in this document, all the cars must have:\\
a reliable GPS tracker\\
a mobile Internet connection (for example a 3G or 4G connection)\\
sensors to collect data from the engine and the battery\\
an electronic switch to lock and unlock the doors\\
a weight sensor on each seat\\
a screen to offer a dedicated interface to users\\
an internal system to control these components and communicate\\ with the central system\\


[+ un qr code stampato sulla macchina perché è comodo per sbloccare]\\


The web application needs an Internet connection to work, for example to connect to the database and find available cars.\\


The mobile application will need at least an Internet connection to receive data from and communicate with the central system. Access to the device’s location is not mandatory, but is needed to provide the “find available cars near me” functionality.\\

\subsection{Assumptions and Dependencies}

See 2.4 Constraints for hardware assumptions.\\


The system has a predefined list of all the safe areas and their locations.\\
The system has a predefined list of all the power grid stations and their locations.\\
The system knows how many plugs are present and how many of them are free.\\


The car’s data connection is always working and stable\\
The car’s gps signal is always available and precise\\


After unlocking a car users turn on the engine shortly after.\\


When the user has ended the reservation or chosen to temporarily park from the car’s screen, we assume that the users and all the passengers have exited the car before the last door is closed.\\


When the weight measured by a seat weight sensor exceeds a certain threshold, it means that a person is present on that seat (and not an object).\\


When a car is unlocked by force or moves without being reserved, the car is flagged as stolen and made unavailable for reservation. \\
The matter is handled by someone else (police, lawyers)\\
-> users wil always find the car if marked available\\


non richiesti da goals: (non pertinenti?)\\
A phone line is available in case of car accidents or damage to the car.\\
-> insurance, assistance, fines\\
If a car is involved in a car accident or otherwise damaged, it is marked as not available.\\


An external agency is entrusted with the task of charging cars with low or dead batteries.\\


An external agency is entrusted with the task of regularly cleaning the inside and outside of cars.\\


\newpage

\section{Specific Requirements}

\subsection{External Interface Requirements}

\subsubsection{User Interfaces}

\subsubsection{Hardware Interfaces}

\subsubsection{Software Interfaces (API)}

\subsubsection{Communication Interfaces}

\newpage
\subsection{Functional Requirements}

\subsubsection{Requisiti}


\begin{itemize}

\item{[G1] Guests must be able to register as a user by choosing a username and providing their personal data, driving license and payment information. They will receive a password at the email address they specified.
	
\begin{itemize}
\item{[RE.1.1] The system must offer an interface (e.g. a form on a web page or on the mobile application) where the user can enter and submit the data needed for registration: personal data (first name, last name, date of birth [more?]), a driving license ID or a photo of one, and a payment method}
\item{[RE.1.2] The system must verify that the data provided by a user on registration is valid [...]}
\item{[RE.1.3] When a user registers the system must randomly generate a safe password and associate it to the user’s account}
\item{[RE.1.4] After a password is generated when a user registers the system must send the password to the user via email at the email address the user provided}
\end{itemize}
}

\item{[G2] Users must be able to log in with the username/email they submitted and the password received on registration.
\begin{itemize}
	\item{[RE.2.1] The system must offer an interface (e.g. a form on a web page or on the mobile application) where the user can enter and submit his credentials (username/email and password) to log in.}
	\item{[RE.2.2] The system must compare the credentials submitted by the user and compare them with the ones saved in the database}
	\item{[RE.2.3] If the credentials submitted on login are valid, the system authenticates the user and allows them to use the available functionalities}
	\item{[RE.2.4] If the credentials submitted on login are not valid, the system denies the user access and notifies the user of the error}
[+ offre di riprovare?]
\end{itemize}
}

\item{[G3a] Users must be able to find the locations of available cars within a certain distance from their current location.
\begin{itemize}
	\item{[RE.3a.1] The system must offer an interface where the user can (activate the option) to look for nearby available cars if the user’s location is available (ex. gps)}
	\item{[RE.3a.2] When the user activates the option to find nearby available cars, the system must look in the database for every available car near the the user’s location}
	\item{[RE.3a.3] The system must show the results of the search for nearby available cars on a suitable *interface* (ex. a map)}
\end{itemize}
}

\item{[G3b] Users must be able to find the locations of available cars in a specified location.
\begin{itemize}
	\item{[RE.3b.1] The system must offer an interface where the user can submit an address and search for available cars near that location}
	\item{[RE.3b.2] When the user starts a search for available cars near a certain address, the system must look in the database for every available car close to the address provided by the user}
	\item{[RE.3b.3] The system must show the results of the search for available cars on a suitable *interface* (e.g. a map)}
\end{itemize}
}

\item{[G4] Users must be able to reserve a car for up to one hour before they pick it up.
\begin{itemize}
	\item{[RE.4.1] The system must offer an interface that shows to the user the cars available for reservation (e.g. the search results specified in RE.3a.3) and allow the user to select a car}
	\item{[RE.4.2] When a user selects a car for reservation the system must mark the car as reserved by that user}
	\item{[RE.4.3] If the car has not been unlocked for an hour after reservation, the system must mark the car as available and charge the user a fixed amount}
	
UTENTI BANNATI NON POSSONO RISERVARE MACCHINE

\end{itemize}
}

\item{[G5] A user that reaches a reserved car must have a way to tell the system they’re nearby, so that the system unlocks the car and the user may enter.
\begin{itemize}
	\item{[RE.5.1] The system must offer an interface to unlock the car, with their position or *car id*/qr code}
	\item{[RE.5.2] If the user is within a certain distance from the car, their device location is available and they choose from the interface to unlock the car with the position *option*, the system must unlock the car}
	\item{[RE.5.3] If the user chooses from the interface to unlock the car with its *id* and the user *submits the right id* corresponding to the car, the system must unlock the car}
-> sbloccare con la posizione disponibile solo quando è vicino?
\end{itemize}
}

\item{[G6] The system must charge the user who reserved the car from the moment the engine is ignited after unlocking it. The amount charged depends on the distance traveled and time elapsed.
\begin{itemize}
	\item{[RE.6.1] The system must keep track until the end of the reservation of the amount the user has to pay.}
	\item{[RE.6.2] The system starts to **charge the user** -> ambiguo, non paga subito  the moment the reserved car’s engine is ignited after unlocking the car.}
	\item{[RE.6.3] The amount charged by the system depends on the time elapsed and the distance traveled by the user, following specific rules.}
\end{itemize}
}

\item{[G7] The system must allow the user to see the amount they’re being charged through a screen on the car.
\begin{itemize}
	\item{[RE.6.1] The system must keep track until the end of the reservation of the amount the user has to pay.}
	\item{[RE.7.1] After the system has started keeping track of the amount that the user has to pay, the system must show it in a clear way on the car screen while the car is unlocked and the reservation hasn’t ended.}
\end{itemize}
}

\item{[G8] The system must stop charging the user as soon as the car is parked in a safe area and the user exits the car after ending the reservation.
\begin{itemize}
	\item{[RE.6.1] The system must keep track until the end of the reservation of the amount the user has to pay.}
	\item{[RE.8.1] The moment a car is parked in a safe area, the system must ask through *an interface* on the car screen if the user wants to end the reservation or just park temporarily.}
	\item{[RE.8.2] If a reserved car has been parked in a safe area and the user has chosen to end the reservation, then  the system must carry out the transaction for the amount that the system calculated, with the method of payment specified by the user on registration.}
	\item{[RE.8.3] If the transaction}
-> si ricorda l’assunzione che quando tutte le porte sono chiuse dopo aver terminato, allora i passeggeri sono tutti usciti
\end{itemize}
}

\item{[G9] Users must be able to leave a car in a safe area without losing the reservation by informing the system that they’re only temporarily parking; in this case the system continues on charging the user.
\begin{itemize}
	\item{[RE.6.1] The system must keep track until the end of the reservation of the amount the user has to pay.}
	\item{[RE.8.1] The moment a car is parked in a safe area, the system must ask through *an interface* on the car screen if the user wants to end the reservation or just park temporarily.}
	\item{[RE.9.1] When a car is temporarily parked and locked, the system keeps on *charging* the user but with different rules than those used in RE.6.3, this time depending only on time elapsed while parked.}
	\item{[RE.9.2] After a temporarily parked car is unlocked by the user and the engine is turned on, the system starts charging the user with the rules used in RE.6.3 again.}
\end{itemize}
}

\item{[G10] The system must lock the car automatically after the user exits the car.
\begin{itemize}
	\item{[RE.8.1] The moment a car is parked in a safe area, the system must ask through *an interface* on the car screen if the user wants to end the reservation or just park temporarily.}
	\item{[RE.10.1] The system must lock the car when the last door has been closed after the user chose to end their reservation or park temporarily.}
\end{itemize}
}

\item{[G11] The system must provide a money saving option to the user, offering a suitable power grid station near the user’s final destination such that the user will get a discount if they park the car there and plug it in the power grid.
\begin{itemize}
	\item{[RE.11.1] The system must offer an interface where the user can select the money saving option, (submitting their final destination)}
	\item{[RE.11.2] When the user submits their final destination for the money saving option, the system must find a suitable power grid station near the ones close to the destination that have at least one free spot}
	\item{[RE.11.3] The system must show on the car screen (e.g. on a map) the location of the power grid station chosen for the money saving option}
	\item{[RE.11.4] The system must apply a discount on the amount the user has to pay if they selected the power saving option and they parked in the station the system chose for them.}
-> c’è un problemino se due utenti si dirigono entrambi a una stazione con 1 posto libero, risolvibile “prenotando” i posti
\end{itemize}
}

\item{[G12] The stations proposed by the system with the money saving option must be chosen in a way that ensures a uniform distribution of cars in the city.
\begin{itemize}
	\item{[RE.12.1] To choose a station in the process specified in RE.11.2, the system selects among all the stations with free spots within a certain distance of the user’s final destination (e.g. 10 minutes by foot) the one with the fewest available cars nearby.}
\end{itemize}
}

\item{[G13] The system must apply a discount of 10\% on the last ride if the user took at least two other passengers onto the car.
\begin{itemize}
	\item{[RE.6.1] The system must keep track until the end of the reservation of the amount the user has to pay.}
	\item{[RE.13.1] If the weight sensors in the car seats detect at least two passengers (excluding the driver) for at least half of the time the car has been driving, then the system must apply a discount of 10\% at the end of the reservation on the amount the user has to pay.}
\end{itemize}
}

\item{[G14] The system must apply a discount of 20\% on the last ride if the car is left with more than 50\% of remaining battery charge.
\begin{itemize}
	\item{[RE.6.1] The system must keep track until the end of the reservation of the amount the user has to pay.}
	\item{[RE.14.1] When the car has been parked in a safe area and the user has chosen to end the reservation, the system must apply a discount of 20\% on the amount the user has to pay if the car is left with more than 50\% remaining battery charge.}
\end{itemize}
}

\item{[G15] The system must apply a discount of 30\% on the last ride if the car is left at special parking areas where they can be recharged, and the user takes care of plugging the car into the power grid.
\begin{itemize}
	\item{[RE.6.1] The system must keep track until the end of the reservation of the amount the user has to pay.}
	\item{[RE.15.1] When the car has been parked in a power grid station, has been plugged in the power grid and the user has chosen to end the reservation, the system must apply a discount of 30\% on the amount the user has to pay.}
\end{itemize}
}

\item{[G16] The system must charge 30\% more if the car is left at more than 3 km from the nearest power grid station or with less than 20\% remaining battery charge.
\begin{itemize}
	\item{[RE.6.1] The system must keep track until the end of the reservation of the amount the user has to pay.}
se la macchina ha terminato la corsa (utente ha indicato di aver finito ed è uscito dalla macchina) e il sistema rileva che è stata parcheggiata a più di 3km di distanza da una qualsiasi stazione, oppure è rimasta meno del 20\% di carica, il sistema chargia 30\% di più sul totale da pagare alla fine del viaggio
	\item{[RE.16.1] When the user has ended the reservation, if the car is parked more than 3 km from the nearest power grid station or has less than 20\% remaining battery charge, the system must increase the amount the user has to pay by 30\%.}
	
se la macchina ha meno di 20\% di carica, la rendiamo non disponibile?
\end{itemize}
}

\end{itemize}

\newpage
\subsection{Use Cases}
(use cases, con sequence/activity diagrams)

	\subsubsection{A guest registers to PowerEnJoy} 	\begin{tabularx}{\textwidth}{  l  X  } 		\hline 		Actor & Guest\\ 		\hline 		Goal & [G1]\\ 		\hline 		PreConditions & The guest had never been registered before\\ 		\hline 		Execution Flow & 1. The guest on the home page clicks on “register” button to start the registration process.\newline 						 				 2. The guest fills in at least all mandatory fields with the required informations(name, surname, username, email address, DOB).\newline 						 			 	 3. The guest uploads a photo of the driving license or inserts manually the informations.\newline 										 4. The guest inserts the number of the credit card and the relative CVV. 						  		 	 5. The system verifies the correctness of the inserted data\newline 						 			 	 6. The guest clicks on “confirm” button.\newline 						 			 	 7. The system generates a password and provides it to the user.\newline 						 			 	 8. The system will save the data in the DB.\newline 						 			 	 9. The system notifies the registration and sends the user to the profile management page.\\ 		\hline 		Postconditions & The guest successfully ends registration process and become a user. From now on he can log in to the application using his credential and start using PowerEnjoy.\\ 		\hline 		Exceptions & 1. The guest is already registered.\newline 					 			 2. The guest inserts invalid information.\newline 					 		   3. The guest inserts a username used by another user.\newline 					 		   4. The guest inserts an email used by another user.\newline 					 		 	 5. The guest doesn't confirm the registration.\newline\newline 					 Each exception is handled warning the guest of the problem and the Execution Flow comes back to the point 2.\\ 		\hline 	\end{tabularx}
	\subsubsection{A user logs in the PowerEnjoy application} 	\begin{tabularx}{\textwidth}{  l  X  } 		\hline 		Actor & Guest\\ 		\hline 		Goal & G[2]\\ 		\hline 		PreConditions & The user must be registered in the system.\\ 		\hline 		Execution Flow & 1. The guest opens the PowerEnjoy application and presses on the login button.\newline 										 2. The guest inserts the username or email and password received during registration.\newline 										 3. The system checks the couple inserted by the user.\newline 										 4. The guest, from now user, is redirected to the page where he can search a car.\\ 		\hline 		Postconditions & The guest is now a user, he is logged in and can use all the functionality of the system.\\ 		\hline 		Exceptions & 1. The guest inserts invalid credentials.\\ 		\hline 	\end{tabularx}
	\subsubsection{A user searches an available car near his position} 	\begin{tabularx}{\textwidth}{  l  X  } 		\hline 		Actor & User\\ 		\hline 		Goal & [G3a]\\ 		\hline 		PreConditions & The user is logged in to the system and he has activated the GPS.\\ 		\hline 		Execution Flow & 1. The user presses the button to be localized on the map.\newline 										 2. The system receives the user's position and checks in the DB all the available cars nearby the user.\newline 										 3. The system shows on the application all the available cars.\newline 										 4. The user navigates on the map to search a car.\\ 		\hline 		Postconditions & The user finds a car most suitable for him.\\ 		\hline 		Exceptions & 1. There aren't any available cars and the system suggests to the user to search in another location.\\ 		\hline 	\end{tabularx}
	\subsubsection{A user searches an available car in a specific position} 	\begin{tabularx}{\textwidth}{  l  X  } 		\hline 		Actor & User\\ 		\hline 		Goal & [G3b]\\ 		\hline 		PreConditions & The user is logged in to the system\\ 		\hline 		Execution Flow & 1. The user presses the search bar to insert a location.\newline 										 2. The user inserts an address (street, building, place (vorrei intendere pub, bar, discoteche))\newline 										 3. The system receives the address inserted by the user and checks in the DB all the available cars nearby the location.\newline 										 4. The system shows on the application all the available cars.\newline 										 5. The user navigates on the map to search a car.\\ 		\hline 		Postconditions & The user finds a car most suitable for him.\\ 		\hline 		Exceptions & 1. The address inserted by the user doesn't exist.\newline 								 2. There aren't any available cars and the system suggests to the user to search in another location.\\ 		\hline 	\end{tabularx}
	\subsubsection{A user reserves a car} 	\begin{tabularx}{\textwidth}{  l  X  } 		\hline 		Actor & User\\ 		\hline 		Goal & [G4]\\ 		\hline 		PreConditions & The user is logged and there is at least an available car.\\ 		\hline 		Execution Flow & 1. The user selects a car in the map.\newline 										 2. The system shows to the user the battery remaining charge.\newline 										 3. The user confirms to reserve the car.\\ 		\hline 		Postconditions & The car is reserved for the user for an hour. \\ 		\hline 		Exceptions & 1. The car is reserved by an another user before the user confirm the reservation.\newline 								 2. The user doesn't confirm the reservation (non so se è un'eccezione)\\ 		\hline 	\end{tabularx}
	\subsubsection{A user unlocks the car with the QR code printed on the car} 	\begin{tabularx}{\textwidth}{  l  X  } 		\hline 		Actor & User\\ 		\hline 		Goal & [G5]\\ 		\hline 		PreConditions & The user is nearby the car he reserved.\\ 		\hline 		Execution Flow & 1. The user presses on the camera button and sends the QR code to the system.\newline 										 2. The system identifies the car with the QR code and checks the reservation.\newline 										 3. The system enables the button to unlock the car on the application.\newline 										 4. The user presses the button.\\ 		\hline 		Postconditions & The car is ready to be ignite.\\ 		\hline 		Exceptions & 1. The user sent a QR code of a car he didn't reserve.\\ 		\hline 	\end{tabularx}
	\subsubsection{A user unlocks the car using his position} 	\begin{tabularx}{\textwidth}{  l  X  } 		\hline 		Actor & User\\ 		\hline 		Goal & [G5]\\ 		\hline 		PreConditions & The user is nearby the car he reserved and has the localization activated.\\ 		\hline 		Execution Flow & 1. The user presses on the localization button and sends to the system his position.\newline 										 2. The system checks the user's position and the reservation.\newline 										 3. The system enables the button to unlock the car on the application.\newline 										 4. The user presses the button.\\ 		\hline 		Postconditions & The car is ready to be ignite.\\ 		\hline 		Exceptions & 1. The user is nearby a car he didn't reserve.\newline 								 2. The user is far from the car he reserved\newline\\ 		\hline 	\end{tabularx}
	\subsubsection{A user parks the car without end the ride} 	\begin{tabularx}{\textwidth}{  l  X  } 		\hline 		Actor & User\\ 		\hline 		Goal & [G9]\\ 		\hline 		PreConditions & The user is employing the car.\\ 		\hline 		Execution Flow & 1. The user stops the car and turns it off.\newline 										 2. The display shows to the user the option:\newline 										 					a) to end the ride;\newline 															b) to stand without losing the control of the car.\newline 										 3. The user presses the button b).\newline 										 4. The user closed the car, keeping the key.\\ 		\hline 		Postconditions & The car is stopped in a parking lot, ready to be used again.\\ 		\hline 		Exceptions & non me ne vengono\\ 		\hline 	\end{tabularx}
	\subsubsection{The system suggests to the user a PGS to park the car and save money} 	\begin{tabularx}{\textwidth}{  l  X  } 		\hline 		Actor & System, user\\ 		\hline 		Goal & [G11]\\ 		\hline 		PreConditions & The user is employing the car.\\ 		\hline 		Execution Flow & 1. The user stops the car and turns it off.\newline 										 2. The display shows to the user the option:\newline 										 					a) to end the ride;\newline 															b) to stand without losing the control of the car.\newline 										 3. The user presses the button a).\newline 										 4. The system obtains the position of the car.\newline 										 5. The system search the nearest PGS and suggests it to the user through the display.\newline 										 6. The user drives to the PGS, parks the car and ends the ride.\newline 										 7. The user plugs in the car in the power grid.\newline 										 8. The system detects that the car is charging.\newline 										 9. The system applies a discount on the amount the user must pay.\\ 		\hline 		Postconditions & The car is parked, ready to be used again and the user has a discount.\\ 		\hline 		Exceptions & 1. There isn't an available PGS.\newline 								 2. The user decides to park the car where he is.\\ 		\hline 	\end{tabularx}

\subsection{Performance Requirements}

\subsection{Design Constraints}

\subsection{Software System Attributes}

\subsubsection{Reliability}

\subsubsection{Availability}

\subsubsection{Security}

\subsubsection{Maintainability}

\subsubsection{Portability}

\newpage{}

\section{Appendix}

\subsection{Alloy Model}

\subsection{Software and tools used}

\subsection{Hours of work}

\newpage{}

\section{Revisions}

\subsection{Changelog}
\end{document}
