\documentclass[english]{article}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{babel}
\usepackage[unicode=true,pdfusetitle,
 bookmarks=true,bookmarksnumbered=false,bookmarksopen=false,
 breaklinks=true,pdfborder={0 0 1},backref=false,colorlinks=false]
 {hyperref}
\usepackage{tabularx}
\usepackage{graphicx}
\graphicspath{{images/}}
\usepackage{svg}
\usepackage{float}
\usepackage{titling}
\renewcommand{\arraystretch}{1.4}
\newcommand{\code}[1]{\texttt{#1}}
\usepackage{array}

\pretitle{%
	\begin{center}
		\LARGE
		\includegraphics[width=250pt]{../other/Logo_blu.png}\\[\bigskipamount]~\\[\bigskipamount]
	}
\posttitle{\end{center}}

\begin{document}

\title{Politecnico di Milano\\
 A.A. 2016–2017 \\
Software Engineering 2: “PowerEnJoy” \\
\emph{Integration Test Plan Document}}

\author{Pietro Ferretti, Nicole Gervasoni, Danilo Labanca}
\date{January 15, 2017}
\maketitle

\newpage

\tableofcontents{}

\newpage

\section{Introduction}

\subsection{Revision History}
\begin{itemize}
	\item{ITDP v1.0, published on January 15, 2017}
\end{itemize}
\subsection{Purpose and Scope}

\paragraph{}
The purpose of this document is to provide a complete description of the integration testing plans for PowerEnjoy. It will focus on testing the proper behavior of the software by checking the 
interoperability between its components.
It is intended for developers and for any team member involved in the testing process.
%TODO inserire outline dei contenuti?

\paragraph{}
The aim of this project is to specify in detail a new digital management software for PowerEnJoy, a car-sharing service that employs electric cars only.

\paragraph{}
PowerEnjoy will offer a very valuable service to its users, letting them borrow cars to drive around the city freely, as an alternative to their own vehicles and public transport.
Among the advantages of using PowerEnJoy we can note being able to find available cars in any place that is served by our system and having dedicated spots to park in (namely, PowerEnJoy's power grid stations).
Furthermore, thanks to the fact that all the cars that we provide are electrically powered, PowerEnJoy is also very environmentally friendly.

%\paragraph{}
%PowerEnJoy's users, after registering, will be able to reserve, unlock and drive the cars our system will provide. Users will be charged per minute until they park the car in a safe area and end the ride.
%Users will be able to park their car temporarily and use it again later, or end their ride remotely.
%
%Our system will incentivize virtuous behaviour by offering several discounts if certain conditions are met (like charging a car at a power grid station).

\subsection{List of Definitions and Abbreviations}

\subsubsection{Definitions}

\begin{itemize}
\item{\textit{Guest}: a person that is not registered to the system.}
\item{\textit{User}: a person that is registered to the system. Users can log in to the system with their email or username and their password. Their first name, last name, date of birth, driving license ID are stored in the database.}
\item{\textit{Safe area}: a location where the user can park and leave the car. Users can end their ride and park temporarily only in these locations. The set of safe areas is predefined by the system.}
\item{\textit{Power grid station}: a place where cars can be parked and plugged in. While a car is plugged in a power grid station its battery will be recharged. Power grid stations are by definition safe areas.}
\item{\textit{Available car}: a car that is currently not being used by any user, and has not been reserved either. Available cars are in good conditions (not dirty nor damaged) and don't have dead batteries.}
\item{\textit{Reservation}:
	\begin{itemize}
		\item{the operation of making a car reserved for a user, i.e. giving permission to unlock and use the car only for that user, forbidding reservations by other users.}
		\item{the time period between the moment a reservation is requested and the moment the user unlocks the car, or the reservation is canceled.}
	\end{itemize}
}
\item{\textit{Ride}: the time period from the moment a reserved car is unlocked to the moment the user notifies that he wants to stop using the car and closes all the doors. A ride doesn't stop when a car is temporarily parked, but continues until the user chooses to leave the car definitely.}
%\item{\textit{Possession}: users that have reserved and unlocked a car are said to have possession of the car. While a user has possession of a car they are the only person that can drive it, lock or unlock it, and no other person can take possession of it until the user frees it. Users lose possession of a car when their ride ends.}
\item{\textit{Temporary parking}: the act of parking a car in a safe area and, after notifying the system, locking it and leaving it for a finite amount of time. The user that does this retains the right to use the car and can unlock it later to use it again.}
\item{\textit{Bill}: a record of the money owed by the user at the end of a ride.}
\item{\textit{Outstanding bill}: a bill that hasn't been paid yet. }
\item{\textit{Suspended user}: a user that cannot reserve or use cars. Usually users are suspended because they have outstanding bills.}
\item{\textit{Payment method}: a way to transfer money from the user to the system. Our system will only accept credit cards and online accounts like Paypal.}
\item{\textit{Payment API}: an interface to carry out money transactions, offered by the external provider associated to the payment method used (e.g. a bank).}
%\item{\textit{CAN bus}: a vehicle bus standard designed to allow micro controllers and devices to communicate with each other.}
\end{itemize}

\subsubsection{Acronyms}
\begin{itemize}
\item{\textbf{DD}: Design Document}
\item{\textbf{RASD}: Requirements Analysis and Specification Document}
\item{\textbf{DB}: Database}
%\item{\textbf{CVV}: Card Verification Value}
\item{\textbf{DOB}: Date of birth}
\item{\textbf{PGS}: Power Grid Station}
\item{\textbf{GPS}: Global Positioning System}
%\item{\textbf{CAN bus}: Controller Area Network bus}
\end{itemize}

\subsubsection{Abbreviations}
\begin{itemize}
\item{\textbf{[Gx]}: Goal}
\item{\textbf{[RE.x]}: Functional Requirement}
\item{\textbf{[UC.x]}: Use Case}
\end{itemize}

\subsection{List of Reference Documents}

\begin{itemize}
	\item{Requirements analysis and specification document: “RASD.pdf”}
	\item{Design document: “DD.pdf”}
	\item{Project description document: “Assignments AA 2016-2017.pdf”}
	\item{Example document: “Integration Testing Example Document.pdf”}
\end{itemize}

\section{Integration Strategy}

\subsection{Entry Criteria}

Before starting the integration testing phase specific conditions concerning the whole project development must be met.

It is fundamental that the Requirements Analysis and Specification Document and the Design Document have been properly written and completed.

Regarding the code development, it is necessary to fully complete 
\begin{itemize}
\item the Resource Subsystem
\item the Model Component in the Application Subsystem.
\end{itemize}
All the other components will be tested, as soon as they are concluded, following the sequence stated in \autoref{subsec:sequence}.
Furthermore, each component has to be successfully unit tested before being involved in the integration testing.


\subsection{Elements to be Integrated}

As stated in the Design Document (paragraph 2.2), the system is based on the cooperation of two parts, the \emph{Application Subsystem}  and the \emph{Resource Management Subsystem}. The first handles all the operations related to the user applications and interfaces, while the second takes care of keeping track of all the automatic updates from the sensors in the cars and the charging stations.
The testing process will verify the correctness of the integration between these macro-components after checking the proper cooperation of smaller components inside each subsystem.
Furthermore, it will be tested the higher integration, client/server level, between
\begin{itemize}
\item the Web Application and the Application Subsystem
\item the Car Application and the Application Subsystem
\end{itemize}
Concerning the external APIs, we expect them to work properly so we will only check, by unit testing, that the components execute correctly the API call.


\paragraph{Application Subsystem}
Components to be tested:
\begin{enumerate}
\item Registration
\item Account Manager
\item Car Search
\item PGS Search
\item Safe Areas Search
\item Payment
\item Reservation Manager
\item Unlocking
\item Parking Ride Manager
\item Ride Manager
\item Report Manager
\item Request Dispatcher
\item Model
\end{enumerate}

It will be tested that the Request Dispatcher interacts with each component from 1 to 10 in the proper way and that these components cooperate as expected with the Model one. In addition, it will be tested the integration between the Model component and the DBMS.

\paragraph{Resource Management Subsystem}
Components to be tested:
\begin{enumerate}
\item Car Manager
\item PGS Manager
\item Car Handler
\end{enumerate}

It will be tested the cooperation between the Car Manager and the Car Handler components and between the PGS Manager and the DBMS.



\subsection{Integration Testing Strategy}
We believe that the most efficient way to test the integration between PowerEnjoy's software components is the \emph{bottom up approach}. Using this strategy, we will be able to test the cooperation between different units as soon as they are fully developed without waiting for the whole subsystem to be ready. This method will also highlight all the possible integration issues while the software is still under development, allowing quicker smaller fixes.
We will start the process from independent components which don't have any dependencies and we will built further integration test on the already  tested software.
As specified in the Design Document, several components of the Application Subsystem depend on the Resource Management Subsystem thus the testing phase will start in this subsystem.


\subsection{Sequence of Component / Function Integration}
\label{subsec:sequence}
In this section we will describe in which order the components of our system will be coupled together to be tested and integrated.
First we will integrate the components in each subsystem separately, then the two subsystems (the Application Subsystem and the Resource Management Subsystem) will be combined together.

We will use diagrams to make the dependencies between components clearer. Arrows from a component to another imply that the first component is necessary for the second one to work correctly.


\subsubsection{Software Integration Sequence}

Following our choice of using a bottom-up approach, integration testing will start from two base components: the DBMS and the Car Internal System.
The DBMS is free from dependencies and can be easily used as a starting point.
The Car Internal System on the other hand, even if it is a prerequisite for many of the system's functions to work, requires an interface to the Resource Management Subsystem that we haven't integration tested yet. Fortunately the interface is used only for sending updates about its status, so the interface functions can be easily replaced by an appropriate stub.


\paragraph{Model}
The first two elements to be integrated will be the Model and the DBMS.
The Model is the foundation of the Application Subsystem and integrating it will let us test all the other components in the subsystem.

\begin{figure}[H]
	\centering
	\makebox[\textwidth][c]{
		\includegraphics[scale=0.25]{seq1.png}
	}
\end{figure}

\textbf{Power Grid Stations Manager}
On the Resource Management Subsystem we can start from integrating the Power Grid Stations Manager with the DBMS. 
The PGS Manager is almost fully independent from the other components and can be tested easily.
\begin{figure}[H]
	\centering
	\makebox[\textwidth][c]{
		\includegraphics[scale=0.25]{seq2.png}
	}
\end{figure}

\paragraph{Car Handler}
The Car Handler is the component that is in charge of issuing commands to the car. We can start testing its behavior as soon as the Car Internal System is fully unit tested. We will make use of a stub to simulate the Resource Subsystem Interface.

\begin{figure}[H]
	\centering
	\makebox[\textwidth][c]{
		\includegraphics[scale=0.25]{seq3b.png}
	}
\end{figure}

\paragraph{Car Manager}
After the Car Handler is integrated we can finally incorporate the Car Manager, the component doing the heavy lifting in the Resource Management Subsystem.
\begin{figure}[H]
	\centering
	\makebox[\textwidth][c]{
		\includegraphics[scale=0.25]{seq4.png}
	}
\end{figure}

Once the Car Manager has been integration tested, we can actually test the interaction between the Car Internal System and the Resource Subsystem Interface.
\begin{figure}[H]
	\centering
	\makebox[\textwidth][c]{
		\includegraphics[scale=0.25]{seq-ciclo-a.png}
	}
\end{figure}

At this point the Resource Management Subsystem is fully integrated.
\begin{figure}[H]
	\centering
	\makebox[\textwidth][c]{
		\includegraphics[scale=0.25]{seq-resource-subs.png}
	}
\end{figure}

\paragraph{Application and Resource Subsystems Integration}
We can now proceed to integrating the Application Subsystem and the Resource Subsystem, again following the bottom-up approach.
\begin{figure}[H]
	\centering
	\makebox[\textwidth][c]{
		\includegraphics[scale=0.25]{seq-subsystemv1.png}
	}
\end{figure}

\paragraph{Application Subsystem Components}
Most of the components in the Application Subsystem are independent from each other, therefore they can be freely tested in parallel.

The Registration Component, the Account Manager, the Car Search Component, the PGS Search Component, the Safe Areas Search Component and the Payment Component only need the Model, while the Reservation Manager, the Unlocking Component, the Parking Component, the Ride Manager and the Report Manager also need to interface with the Resource Subsystem. 



\begin{figure}[H]
	\centering
	\makebox[\textwidth][c]{
		\includegraphics[scale=0.25]{seq-model1.png}
	}
\end{figure}
\begin{figure}[H]
	\centering
	\makebox[\textwidth][c]{
		\includegraphics[scale=0.25]{seq-model2b.png}
	}
\end{figure}


\paragraph{Request Dispatcher}
The Request Dispatcher acts as a wrapper for all of the requests to the application API, processing and distributing them to the corresponding components. 

This allows us to integrate it with thread based testing: when testing for one of the intermediate components has been finished, we can test the corresponding functionality on the Request Dispatcher, that will interact with the specific component.
The request dispatcher will be integrated one by one with all the other components, until the Application Subsystem is complete.

\begin{figure}[H]
	\centering
	\makebox[\textwidth][c]{
		\includegraphics[scale=0.25]{seq-dispatcher.png}
	}
\end{figure}


\paragraph{Client Applications Integration}
Finally, after the whole central system is tested and has been successfully integrated, we will test the interaction between the client applications and the system.

\begin{figure}[H]
	\centering
	\makebox[\textwidth][c]{
		\includegraphics[scale=0.25]{seq-clients.png}
	}
\end{figure}



\section{Individual Steps and Test Description}

% qui se vogliamo potremmo dire che non descriviamo tutti i metodi esistenti ma solo quelli critici/più importanti

% Non serve scrivere metodi, basta dire cose come "Qui passiamo nomi utente e dati della patente, successo, poi passiamo nomi utente già esistenti, ci aspettiamo errore, poi patente errata, errore,..."

%TODO aggiungere tipi di input per ogni azione
%TODO aggiungere casi di input errati per ogni azione
%TODO aggiungere risultati per ognuno degli input
%TODO riscrivere tutto bene

Also, try all combinations of null values.
Also, try passing parameters of the wrong type.

AUTHENTICATION!
- maintenance
- pgs
- car update
- application components?

\subsection{Model - DBMS}
azioni da componenti sul model
- le azioni di delete
- richieste di tutte le reservation/ride esistenti (serve?)

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Insert User}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A username, an email, the user's personal data, a license id number and a payment method (e.g. a valid credit card number). & A new user is inserted in the database. \\
		\hline
		Some of the parameters are missing. & The insertion fails. \\
		\hline
		Invalid parameters? & error\\
		\hline
	\end{tabular}
\end{center}
\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Update User}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		correct request & user data updated \\
		\hline
		updating with unacceptable data & fail \\
		\hline
		trying to update a nonexistent user & fail \\
		\hline
	\end{tabular}
\end{center}

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Insert Bill}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid user and a well-formed bill. & The bill is added to the user's bills in the database. \\
		\hline
		A valid user and an ill-formed bill & *An error is raised.* \\
		\hline
		A non-existent user and a bill & *An error is raised* \\
		\hline
	\end{tabular}
\end{center}

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline
		\multicolumn{2}{|c|}{\textbf{List Bills}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid user & Returns the user's bills \\
		\hline
		A valid user with no bills & Returns an empty set \\
		\hline
		A non-existent user & *An error is raised* \\
		\hline
	\end{tabular}
\end{center}

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline
		\multicolumn{2}{|c|}{\textbf{List Cars}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		Nothing & Returns a set of all cars and *information about them, position, battery ecc.* \\
		\hline
	\end{tabular}
\end{center}

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{List Power Grid Stations}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		Nothing & Returns a set of all power grid stations and *their position, their availability* \\
		\hline
	\end{tabular}
\end{center}

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{List Safe Areas}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		Nothing & Returns a set of all safe areas and *their position* \\
		\hline
	\end{tabular}
\end{center}

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Insert Reservation}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid user, an available car & A new reservation is created in the database. \\
		\hline
		A valid user, a car that is not available & *An error is raised* \\
		\hline
		A non-existent user, a car & *An error is raised* \\
		\hline
		A suspended user, a car & *An error is raised* \\
		\hline
	\end{tabular}
\end{center}

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline
		\multicolumn{2}{|c|}{\textbf{Update Reservation}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		An existent ongoing reservation, valid data to update & The reservation is updated with the new data. \\
		\hline
		An existent ongoing reservation, invalid data to update & error \\
		\hline
		A canceled reservation, data to update & error \\
		\hline
		An ended reservation, data to update & error \\
		\hline
		A non-existest reservation, data to update & error \\
		\hline
	\end{tabular}
\end{center}

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Insert Ride}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid user, a car currently reserved by the user & A new ride is created in the database. \\
		\hline
		A valid user, a car not currently reserved by the user & error \\
		\hline
		A valid user, a non-existent car & error \\
		\hline
		A non-existent user, a car & error \\
		\hline
		A suspended user, a car & error \\
		\hline
	\end{tabular}
\end{center}


\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Update Ride}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid ride and valid data to update  & The ride is updated with the new data. \\
		\hline
		A valid ride, invalid data to update & error \\
		\hline
		A non-existent ride, data to update & error \\
		\hline
		% casi in cui la ride è già terminata? si può ancora modificare?
	\end{tabular}
\end{center}

\subsection{PGS Manager - DBMS}
azioni da interfaccia esterna
- update plugs 
	-> disponibile 
	-> non disponibile
in teoria non dovrebbero esserci richieste errate perché sono solo messaggi delle stazioni, ma mettiamo casi di errore

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Update Plug Availability}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid plug id and its availability (different from the current one) & The plug's availability is updated in the database. \\
		\hline
		A valid plug id and its availability (the same as the current one) & Nothing changes, returns a "Not Modified"? \\
		\hline
		An invalid plug id and an availability & error \\
		\hline
	\end{tabular}
\end{center}

\subsection{Car Handler - Car Internal System}
azioni da car manager a car handler
- richiesta di informazioni
- lock
- unlock

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline
		\multicolumn{2}{|c|}{\textbf{Request Update from Car}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid car id and a valid *request type* & The request is sent to the car and the car sends an update to the Car Manager. \\
		\hline
		A valid car id and an invalid *request type* & error \\
		\hline
		A non-existent car id and a request type & error \\
		\hline
	\end{tabular}
\end{center}

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Lock Car}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid car id & The car is locked. \\
		\hline
		A non-existent car id  & error \\
		\hline
		% caso a parte se la macchina è già chiusa?
	\end{tabular}
\end{center}

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Unlock Car}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid car id & The car is unlocked. \\
		\hline
		A non-existent car id & error \\
		\hline
		% caso a parte se la macchina è già sbloccata?
	\end{tabular}
\end{center}

\subsection{Car Manager - Car Handler - DBMS}

\subsubsection{Maintenance}
\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{List Cars in Need of Maintenance}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		Valid authentication credentials & Returns a set with all cars in need of maintenance, along with *information about the issues and their position* \\
		\hline
		Invalid authentication credentials & error (access forbidden) \\
		\hline
	\end{tabular}
\end{center}

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline
		\multicolumn{2}{|c|}{\textbf{Set Car as Available}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		Valid authentication credentials, a valid car id & The car is set as available. \\
		\hline
		Valid authentication credentials, a non-existent car id & error \\
		\hline
		Invalid authentication credentials, a car id & error \\
		\hline
		% what if the car is already available
	\end{tabular}
\end{center}

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Set Car as Unavailable}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		Valid authentication credentials, a valid car id and a reason for making it unavailable & The car is set as unavailable and the reason is saved on the database. \\
		\hline
		Valid authentication credentials, a valid car id and no reason to for making it unavailable & error? \\ % forziamo a dare una spiegazione?
		\hline
		Valid authentication credentials, a non-existent car id & error \\
		\hline
		Invalid authentication credentials, a car id  & error \\
		\hline
	\end{tabular}
\end{center}

\subsubsection{Interface to the Application Subsystem}
\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline
		\multicolumn{2}{|c|}{\textbf{Request to Lock Car}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid car id & The car is locked. \\
		\hline
		A non-existent car id  & error \\
		\hline
		% caso a parte se la macchina è già chiusa?
	\end{tabular}
\end{center}

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Request to Unlock Car}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid car id & The car is unlocked. \\
		\hline
		A non-existent car id & error \\
		\hline
		% caso a parte se la macchina è già sbloccata?
	\end{tabular}
\end{center}

\subsubsection{Car Interface}
\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Car Status Update}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A car's valid authentication credentials, well-formed info about the car's status & The car's status is updated in the database. \\
		\hline
		A car's valid authentication credentials, ill-formed info about the car's status & error \\
		\hline
		Invalid car authentication credentials and info about a car's status  & error \\
		\hline
	\end{tabular}
\end{center}

\subsection{Application Subsystem Components - Model}
azioni da request dispatcher


\subsubsection{Registration Component - Model}
- registrazione utente
\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Register User}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A not-yet-taken username, an email, valid personal data, a valid payment method and a valid driving license id number & A new user is created in the database and an email containing the user's password is sent to the email address provided. \\
		\hline
		A not-yet-taken username, an email, valid personal data, a valid payment method and a picture of a valid driving license & A new user is created in the database and an email containing the user's password is sent to the email address provided. \\
		\hline
		A not-yet-taken username, an email, valid personal data, a valid payment method and an invalid driving license & error \\
		\hline
		A not-yet-taken username, an email, valid personal data, an invalid payment method and a driving license & error \\
		\hline
		A not-yet-taken username, an email, invalid personal data, a payment method and a driving license & error \\
		\hline
		An already taken username, an email, personal data, a payment method and a driving license & error \\
		\hline
		An ill-formed username, an email, personal data, a payment method and a driving license & error \\
		\hline
	\end{tabular}
\end{center}

\subsubsection{Account Manager - Model}
- login
- getinfo utente
- update info utente
- list bills
\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Login}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid username and the correct corresponding password  & Creates a session for the user and returns a session token. \\
		\hline
		A valid username and a wrong password & error \\
		\hline
		A non-existent username and a password & error \\
		\hline
	\end{tabular}
\end{center}

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Get User Info}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid session token & Returns all the session user's info \\
		\hline
		An invalid session token & error \\
		\hline
	\end{tabular}
\end{center}

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Update User Info}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid session token and valid new data to update & The user info is updated with new data on the database. \\
		\hline
		A valid session token and invalid new data & error \\
		\hline
		An invalid session token and new data & error \\
		\hline
	\end{tabular}
\end{center}

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{List User Bills}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid session token & Returns a set with all the user's bills \\
		\hline
		An invalid session token & error \\
		\hline
	\end{tabular}
\end{center}

\subsubsection{Car Search Component- Model}
- find cars with position
- find cars with address

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\multicolumn{2}{|c|}{\textbf{Find Cars with Position}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid geographic position & Returns a list of all the cars close to that position, along with *their info*. \\
		\hline
		An invalid geographic position & error \\
		\hline
	\end{tabular}
\end{center}

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Find Cars with Address}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid well-formed address & Returns a list of all the cars close to that address, along with *their info*. \\
		\hline
		An invalid address & error \\
		\hline
	\end{tabular}
\end{center}

\subsubsection{PGS Search Component- Model}
- find stations with position
- find stations with address


\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Find Stations with Position}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid geographic position & Returns a list of all the charging stations close to that position, along with *their info*. \\
		\hline
		An invalid geographic position & error \\
		\hline
	\end{tabular}
\end{center}

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Find Stations with Address}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid well-formed address & Returns a list of all the charging stations close to that address, along with *their info*. \\
		\hline
		An invalid address & error \\
		\hline
	\end{tabular}
\end{center}

\subsubsection{Safe Areas Search Component - Model}
- find safe areas with position 
- find safe areas with address

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Find Safe Areas with Position}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid geographic position & Returns a list of all the safe areas close to that position. \\
		\hline
		An invalid geographic position & error \\
		\hline
	\end{tabular}
\end{center}

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Find Safe Areas with Address}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid well-formed address & Returns a list of all the safe areas close to that address. \\
		\hline
		An invalid address & error \\
		\hline
	\end{tabular}
\end{center}

\subsubsection{Payment Component- Model}
- pay a bill 

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Pay a Bill}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid session token, a bill that needs to be paid and a valid payment method &  The transaction is carried out and the bill is marked as paid. \\
		\hline
		A valid session token, a bill that needs to be paid and an invalid payment method & error \\ % distinguere tra not well-formed payment method e errore durante la transazione?
		A valid session token and a bill that needs to be paid & The system uses the payment method saved for the user to carry out the transaction; if it succeeds the bill is marked as paid, otherwise *error* \\
		\hline
		A valid session token and a bill that has already been paid & error \\
		\hline
		A valid session token and a non-existent bill & error \\
		\hline
		An invalid session token and a bill & error \\
		\hline
	\end{tabular}
\end{center}

\subsubsection{Reservation Manager - Model - Resource Subsystem}
- crea reservation
- annulla reservation

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Create Reservation}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid session token for a user that has no current reservation, an available car & A new reservation is created. \\
		\hline
		A valid session token for a user that has no current reservation, a car that is not available & error \\
		\hline
		A valid session token for a user that has no current reservation, a non-existent car & error \\
		\hline
		A valid session token for a user with an ongoing reservation, a car & error \\
		\hline
		An invalid session token and a car & error \\
		\hline
	\end{tabular}
\end{center}

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Cancel Reservation}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid session token and an ongoing reservation made by the user & The reservation is canceled. \\
		\hline
		A valid session token and an ongoing reservation made by another user & error \\
		\hline
		A valid session token and a reservation that has already ended & error \\
		\hline
		An invalid session token and a reservation & error \\
		\hline
	\end{tabular}
\end{center}

\subsubsection{Unlocking Component - Model - Resource Subsystem}
- sblocca macchina (-> nb fa partire il conto del tempo)

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Unlock Car with Code}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid session token, the code of the car that is currently being reserved by the user & The car is unlocked. \\
		\hline
		A valid session token, the code of a car that is not currently being reserved by the user & error \\
		\hline
		A valid session token, an invalid car code & error \\
		\hline
		An invalid session token & error \\
		\hline
	\end{tabular}
\end{center}

\begin{center}
	
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Unlock Car with Position}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid session token for a user that has an ongoing reservation, a geographic position close to the car that the user has reserved  & The car is unlocked. \\
		\hline
		A valid session token for a user that has an ongoing reservation, a geographic position far from the car that the user has reserved & error \\
		\hline
		A valid session token for a user that has no ongoing reservation, a geographic position & error \\
		\hline
		An invalid session token & error \\
		\hline
	\end{tabular}
\end{center}

\subsubsection{Parking Component - Model - Resource Subsystem}
- metti la macchina in sosta

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Park Car}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid session token for a user that has an ongoing ride  & If the car has been stopped and the car's position is in a safe area, then the car is locked, otherwise *error* \\
		\hline
		A valid session token for a user that has no ongoing ride &  error \\
		\hline
		An invalid session token & error \\
		\hline
	\end{tabular}
\end{center}

\subsubsection{Ride Manager - Model - Resource Subsystem}
- fine ride

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{End Ride}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid session token for a user that has an ongoing ride  & If the car has been stopped and the car's position is in a safe area, then the car is locked and the ride is marked as ended, otherwise *error* \\
		\hline
		A valid session token for a user that has no ongoing ride &  error \\
		\hline
		An invalid session token & error \\
		\hline
	\end{tabular}
\end{center}

\subsubsection{Report Manager - Model - Resource Subsystem}
- aggiungi report

\begin{center}
	\begin{tabular}{ | p{6cm} | p{6cm} | }
		\hline 
		\multicolumn{2}{|c|}{\textbf{Report Issue}} \\
		\hline
		\multicolumn{1}{|c|}{\textit{Input}} & \multicolumn{1}{c|}{\textit{Result}} \\
		\hline
		A valid session token for a user with an ongoing reservation or ride, an explanation of the issue & The issue is recorded and the car is set as unavailable as soon as possible \\
		\hline
		A valid session token for a user with no ongoing reservation or ride & error \\
		\hline
		An invalid session token & error \\
		\hline
	\end{tabular}
\end{center}

request dispatcher:
\subsection{Request Dispatcher - Application Components}
- questa è l'api descritta nel DD, diciamo soltanto che deve comportarsi nel modo che abbiamo già detto nei dettagli

client applications:
\subsection{Mobile/Web Application - Application Subsystem}
- qui diciamo che proviamo l'applicazione in tutte le sue funzionalità e devono funzionare tutte

\subsection{Car Application - Application Subsystem}
- stessa cosa qui

%% se necessario possiamo usare longtable

\subsection{Integration between subsystems}

\section{Tools and Test Equipment Required}

\subsection{Tools}
%TODO JMeter? 

% Identify all tools and test equipment needed to accomplish the integration. Refer to the tools presented during the lectures. Explain why and how you are going to use them. Note that you may also use manual testing for some part. Consider manual testing as one of the possible tools you have available.

In order to test the software in the most efficient way, we will use some tools for automated testing.

\paragraph{Mockito}
It is an open source testing framework for Java released under the MIT License. It allows the \emph{creation of mock objects} in automated unit tests.
It supports \emph{scaffolding and stubs}.\\
\url{http://site.mockito.org/}

\paragraph{JUnit}
JUnit is a simple, open source framework used \emph{to write and run repeatable tests}. It is an instance of the xUnit architecture for unit testing frameworks. JUnit features include: assertions for testing expected results, test fixtures for sharing common test data and test runners for running tests.\\
\url{http://junit.org/junit4/}

\paragraph{Arquillian}
It is a test framework that can be used to perform testing inside a remote or embedded container, or deploy an archive to a container so the test can interact as a remote client; in addition Arquillian integrates with other testing frameworks (e.g., JUnit 4), allowing the use of IDE and Maven test plugins.
It will be used mainly for \emph{testing dependency injections} and \emph{transaction control}.\\
\url{http://arquillian.org/}


%TODO chapter of this document, we are going to use speciﬁc performance analysis tools to make sure that the applications for all the target mobile platforms, regardless whether they’re destined to taxi drivers or to passengers, have reasonable CPU and main memory usages. Depending on the speciﬁc platform we are targeting, the tools we are going to use are:


\subsection{Test Equipment Required}
In order to ensure our software to work properly in the majority of cases, we will test our client components on:
\begin{itemize}
\item an Android smartphone or tablet,
\item an Apple smartphone or tablet,
\item a Windows smartphone or tablet.
\end{itemize}
Since we are developing a responsive web application, it is enough to check the software behavior with different mobile OS and thus browsers. Therefore we will also test the application on a computer using different browsers (Chrome, Explorer, Safari, Firefox).
Additionally we will test our car application on each model of car owned by the PowerEnjoy company.

\section{Program Stubs and Test Data Required}


\section{Effort Spent}
\begin{itemize}
	\item{Pietro Ferretti:  hours of work}
	\item{Nicole Gervasoni:  hours of work}
	\item{Danilo Labanca:  hours of work}
\end{itemize}

\end{document}
